var Texpand=Class.create();Texpand.prototype={initialize:function(b){var c=this;this.element=$(b);this.increment=30;if(this.element.tagName.toLowerCase()!='textarea')throw('Texpand: can only be initialized with a <textarea> but got <'+this.element.tagName.toLowerCase()+'>');if(typeof Prototype=='undefined'||(parseFloat(Prototype.Version.split(".")[0]+"."+Prototype.Version.split(".")[1])<1.6))throw('Texpand: requires Prototype 1.6.0+');if(typeof Effect=='undefined')throw('Textpand: requires Script.aculo.us, specifically Effects');this.element.insert({after:'<div id="texpand-mimic-'+this.element.identify()+'"></div>'});this.mimic=this.element.next();this.mimic.update(this.element.value);if(Prototype.Browser.IE){var d=this.element.getStyle('fontSize');if(d.search(/em/)>=0){var e=parseFloat(d.replace(/em/,''))*10;this.element.setStyle({fontSize:e+'px'})}}var f={};var g=$w('borderBottomColor borderBottomStyle borderBottomWidth borderTopColor borderTopStyle borderTopWidth borderRightColor borderRightStyle borderRightWidth borderLeftColor borderLeftStyle borderLeftWidth fontSize fontFamily fontWeight letterSpacing lineHeight marginTop marginRight marginBottom marginLeft paddingTop paddingRight paddingBottom paddingLeft textAlign textIndent width wordSpacing');g.each(function(a){f[a]=c.element.getStyle(a)});this.mimic.setStyle(f);this.mimic.setStyle({display:'block',position:'absolute',left:'-9999px',top:'-9999px'});this.element.observe("keyup",c._autoExpand.bind(c));return this.element},_autoExpand:function(b){this.mimic.update(this.element.value.replace(/\n/gm,'<br />'));var c=this.mimic.getHeight();var d=this.element.getHeight();var e=d-c;var f=d+(this.increment-e);if(e<this.increment){var g=Effect.Queues.get('texpand'+this.element.identify());g.each(function(a){a.cancel()});this.element.morph('height: '+f+'px;',{duration:0.1,queue:{position:'end',scope:'texpand'+this.element.identify(),limit:2}})}}};